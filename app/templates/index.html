{% extends "base.html" %}

{% block content %}
{% if current_user.is_authenticated %}
    <div class="grid grid-cols-3 gap-4 mb-8">
        <div class="bg-green-200 p-4 rounded">
            <h2 class="text-xl font-bold">Заработок</h2>
            <p class="text-2xl">{{ total_income }}</p>
        </div>
        <div class="bg-blue-200 p-4 rounded">
            <h2 class="text-xl font-bold">Итоговый баланс</h2>
            <p class="text-2xl">{{ total_balance }}</p>
        </div>
        <div class="bg-red-200 p-4 rounded">
            <h2 class="text-xl font-bold">Затраты</h2>
            <p class="text-2xl">{{ total_expense }}</p>
        </div>
    </div>

    <h2 class="text-2xl font-bold mb-4">Добавить транзакцию</h2>
    <form action="{{ url_for('main.add_transaction') }}" method="post" class="mb-8">
        <input type="number" name="amount" placeholder="Сумма" required class="p-2 mr-2">
        <select name="type" required class="p-2 mr-2">
            <option value="Заработок">Заработок</option>
            <option value="Трата">Трата</option>
        </select>
        <input type="text" name="description" placeholder="Описание" class="p-2 mr-2">
        <button type="submit" class="bg-blue-500 text-white p-2 rounded">Добавить транзакцию</button>
    </form>

    <h2 class="text-2xl font-bold mb-4">История транзакций</h2>
    <table class="w-full">
        <thead>
            <tr>
                <th class="text-left">Дата</th>
                <th class="text-left">Тип</th>
                <th class="text-left">Сумма</th>
                <th class="text-left">Описание</th>
                <th class="text-left">Действия</th>
            </tr>
        </thead>
        <tbody>
            {% for transaction in transactions %}
            <tr>
                <td>{{ transaction.date.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>{{ transaction.type }}</td>
                <td>{{ transaction.amount }}</td>
                <td>{{ transaction.description }}</td>
                <td>
                    <a href="{{ url_for('main.edit_transaction', id=transaction.id) }}" class="text-blue-500">Изменить</a>
                    <a href="{{ url_for('main.delete_transaction', id=transaction.id) }}" class="text-red-500 ml-2">Удалить</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <h2 class="text-2xl font-bold mb-4">Добро пожаловать в финансовый трекер!</h2>
    <p class="mb-4">Пожалуйста <a href="{{ url_for('main.login') }}" class="text-blue-500">авторизуйтесь</a> или <a href="{{ url_for('main.register') }}" class="text-blue-500">зарегистрируйтесь</a> чтобы начать отслеживать ваши финансовые действия!</p>
{% endif %}
{% endblock %}